---
tags: []
index_img: ../banner_images/banne_photo96.png
categories:
  - js逆向
date: 2023-07-16 09:12:38
title:
---

p(s)为body加密
sign(r)为h5st加密
![](../Pasted%20image%2020230716091309.png)


操作前提：追异步得慢慢追，按f11逐步跳过，遇到连续循环的话就按shift+f11跳出当前函数。


![](../Pasted%20image%2020230716091717.png)

遇到大量的平坦流就就在每个ruturn打下断点。里面很多重复混淆的操作，不要管，先运行，看结果是否是我们所需要的，然后在断定哪个参数是我需要找出来的，然后一步步解出来。


这里我们记录一下8这个点的操作流程，还是老规则，每个关键的case都打上断点，记录一下执行的结果和顺序，了解整个加密的过程是如何实现的，这里要用恢复脚本执行来迅速判断。

![](../Pasted%20image%2020230716092117.png)

1. 跳7，获取13位时间戳![](../Pasted%20image%2020230716092314.png)
2. 跳6的S的赋值，略过
3. 跳3的W的赋值![](../Pasted%20image%2020230716092448.png)
4. 跳1应该是用“，”分割字符串![](../Pasted%20image%2020230716092750.png)
5. 跳2是h5st的执行结果![](../Pasted%20image%2020230716092916.png)可以看到有w，A，s，r四个参数，w是上述的3的W赋值，A为7的时间戳，S为时间具体数![](../Pasted%20image%2020230716093138.png)